namespace = sgm_fleet

country_event = {								# Opens fleet menu
	id = sgm_fleet.1
	is_triggered_only = yes
	title = sgm_fleet_1_title
	desc = sgm_fleet_1_desc
	picture = GFX_evt_ship_in_orbit

	trigger = {
		exists = root
		exists = from
		from = { is_scope_type = fleet }
	}

	immediate = { }

	option = {
		NAME = increase_multiplier
		change_variable = {
			which = multiplier
			value = 1
		}
		country_event = {
			id = sgm_fleet.1
			scopes = {
				from = from
			}
		}
	}

	option = {
		NAME = decrease_multiplier
		allow = {
			check_variable = {
				which = multiplier
				value > 1
			}
		}
		change_variable = {
			which = multiplier
			value = -1
		}
		country_event = {
			id = sgm_fleet.1
			scopes = {
				from = from
			}
		}
	}

	option = {
		NAME = DELETE_FLEET
		from = { delete_fleet = this }
	}

	option = {
		NAME = change_ownership_to_target_country
		allow = {
			exists = event_target:target_country
		}
		from = {
			set_owner = event_target:target_country 
		}
	}

	option = {
		NAME = set_owner_target_country
		allow = {
			exists = event_target:target_country
		}
		from = {
			save_global_event_target_as = target_country 
		}
	}

	option = {
		NAME = ADD_CORVETTE
		while = {
			count = multiplier
			from = {
				create_ship = {
					random_existing_design = corvette
				}
			}
		}
	}

	option = {
		NAME = ADD_DESTROYER
		while = {
			count = multiplier
			from = {
				create_ship = {
					random_existing_design = destroyer
				}
			}
		}
	}

	option = {
		NAME = ADD_CRUISER
		while = {
			count = multiplier
			from = {
				create_ship = {
					random_existing_design = cruiser
				}
			}
		}
	}

	option = {
		NAME = ADD_BATTLESHIP
		while = {
			count = multiplier
			from = {
				create_ship = {
					random_existing_design = battleship
				}
			}
		}
	}

	option = {
		NAME = add_random_design_from_fleet
		while = {
			count = multiplier
			from = {
				random_owned_ship = {
					fleet = {
						create_ship = {
							design = prevprev.owner
						}
					}
				}
			}
		}
	}

	option = {
		NAME = set_target_country_as_player
		allow = {
			event_target:target_country = {
				is_ai = no
			}
			from = {
				owner = { is_ai = yes }
			}
		}
		from = {
			owner = { 
				if = {
					limit = {
						event_target:target_country = {
							is_gm = yes
						}
					}
					set_country_flag = sgm_assumed_control
				}
				set_player = event_target:target_country 
			}
		}
		event_target:target_country = {
			remove_country_flag = sgm_assumed_control
		}
	}

	option = {
		NAME = Exit
	}
}

# modify starbase
country_event = {
	id = sgm_fleet.2
	is_triggered_only = yes
	title = modify_starbase
	desc = modify_starbase_desc

	immediate = {
		if = {
			limit = {
				NOR = {
					has_global_flag = modifying_starbase_buildings
					has_global_flag = modifying_starbase_modules
				}
			}
			set_global_flag = modifying_starbase_buildings
		}
	}

	option = {
		NAME = modifying_buildings
		trigger = {
			has_global_flag = modifying_starbase_buildings
		}
		set_global_flag = modifying_starbase_modules
		remove_global_flag = modifying_starbase_buildings
		country_event = {
			id = sgm_fleet.2
			scopes = {
				from = from
			}
		}
	}
	option = {
		NAME = modifying_modules
		trigger = {
			has_global_flag = modifying_starbase_modules
		}
		remove_global_flag = modifying_starbase_modules
		set_global_flag = modifying_starbase_buildings
		country_event = {
			id = sgm_fleet.2
			scopes = {
				from = from
			}
		}
	}

	# starbase buildings

	option = {
		NAME = hydroponics_bay 
		trigger = {
			has_global_flag = modifying_starbase_buildings
		}
		from = {
			set_starbase_building = {
				building = hydroponics_bay 
			}
		}
	}
	
}